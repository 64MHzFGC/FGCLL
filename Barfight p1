extends CharacterBody3D

const SPEED = 5.0
const JUMP_VELOCITY = 8.5
const Gravity = 20
const MAX_FALL_SPEED = 8.5
var facing_right=true
var isJumping = false
var airVelocity = 0

func _physics_process(delta):
	var move_dir = 0
	var just_jump = false
	var grounded = is_on_floor()
	
	move_dir = 0
	if Input.is_action_pressed("Move_left"):
		if grounded:
			move_dir -= 1
		if isJumping:
			airVelocity = -5
	if Input.is_action_pressed("Move_right"):
		if grounded:
			move_dir += 1
		if Input.is_action_pressed("Jump"):
			airVelocity = 5

	## trying to make the character velocity determined by direction pressed while grounded

	velocity.y -= Gravity * delta
	velocity.x = move_dir * SPEED + airVelocity
		
	move_and_slide()
	
	if velocity.y < -MAX_FALL_SPEED:
		velocity.y = -MAX_FALL_SPEED
	if grounded: 
		velocity.y = 0.1
		if Input.is_action_pressed("Jump"):
			velocity.y = JUMP_VELOCITY
	if isJumping:
		velocity.x = airVelocity

